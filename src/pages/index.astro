---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import ProjectCard from '../components/ProjectCard.astro';
import site from '../config/site';

// Dynamically import all project MDX files
const projectFiles = await Astro.glob('./projects/*.mdx');

// Filter and transform projects for showcase
const projects = projectFiles
  .filter(project => project.frontmatter.showcase === true)
  .map(project => ({
    title: project.frontmatter.title || '',
    description: project.frontmatter.description || '',
    href: project.url || '',
    date: project.frontmatter.date
  }))
  .sort((a, b) => new Date(b.date || 0).getTime() - new Date(a.date || 0).getTime());
---
<BaseLayout title={`${site.name} — Developer`} description={`Resume and portfolio of ${site.name}, software engineer.`} >
  <Header />

  <section class="mt-4 sm:mt-6">
    <div class="card-responsive">
      <h2 class="text-responsive-lg font-semibold tracking-tight text-theme-primary">About <span class="text-theme-accent">me</span></h2>
      <div class="mt-3 text-theme-tertiary leading-relaxed text-responsive-base space-y-3">
        {site.about.split('\n\n').map((paragraph: string) => (
          <p>{paragraph}</p>
        ))}
      </div>
      <div class="mt-4 flex flex-wrap gap-2">
          {site.skills.map((skill, i) => (
            <span class={`inline-flex items-center rounded-full px-2 sm:px-3 py-1 text-xs ${[
              'bg-indigo-50 text-indigo-700',
              'bg-violet-50 text-violet-700',
              'bg-rose-50 text-rose-700',
              'bg-cyan-50 text-cyan-700'
            ][i % 4]}`}>{skill}</span>
          ))}
      </div>
    </div>
  </section>

  <section class="mt-6 sm:mt-8">
    <div class="card-responsive">
      <h3 class="text-responsive-md font-semibold tracking-tight text-theme-primary">Interests</h3>
      <div class="mt-3 flex flex-wrap gap-2">
        {site.interests.map((interest, i) => (
          <span class={`inline-flex items-center rounded-full px-3 py-1 text-xs ${[
            'bg-emerald-50 text-emerald-700',
            'bg-orange-50 text-orange-700',
            'bg-purple-50 text-purple-700'
          ][i % 3]}`}>{interest}</span>
        ))}
      </div>
    </div>
  </section>

  <section class="mt-8 sm:mt-10">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-4">
      <h2 class="text-responsive-lg font-semibold text-theme-primary">Selected <span class="text-theme-accent">projects</span></h2>
      <a href="/projects" class="text-responsive-sm text-theme-tertiary hover:text-theme-primary transition-colors duration-200 self-start sm:self-auto">See all →</a>
    </div>
    <div class="mt-4 grid-responsive-2 gap-4 sm:gap-5">
      {projects.map(p => (
        <ProjectCard title={p.title} description={p.description} href={p.href} />
      ))}
    </div>
  </section>

  <section class="mt-8 sm:mt-10">
    <h2 class="text-responsive-lg font-semibold text-theme-primary">Contact</h2>
    <p class="mt-2 text-responsive-base text-theme-tertiary">
      I'm always interested in new opportunities and interesting projects. 
      Check out my <a class="underline text-theme-accent hover:text-theme-accent transition-colors duration-200" href="/contact">contact page</a>,
      drop me a line at <a class="underline text-theme-accent hover:text-theme-accent transition-colors duration-200" href={`mailto:${site.social.email}`}>{site.social.email}</a> 
      or check out my work on <a class="underline text-theme-accent hover:text-theme-accent transition-colors duration-200" href={site.social.GitHub}>GitHub</a>.
    </p>
  </section>
</BaseLayout>
